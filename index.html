<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cat√°logo Integral ALPACEL (Hecho por Lic. Cecilia Avila)</title>
  <style>
    :root{
      --bg:#0b1220; --card:#111a2e; --muted:#9fb0d0; --text:#eaf0ff;
      --accent:#4aa3ff; --chip:#1a2745; --ok:#25d366;
      --border:#243556;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:linear-gradient(180deg,#0b1220,#070b14);
      color:var(--text);
    }
    header{
      position:sticky; top:0; z-index:5;
      background:rgba(11,18,32,.92);
      border-bottom:1px solid var(--border);
      backdrop-filter: blur(10px);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:18px 16px;}
    h1{margin:0 0 6px 0; font-size:20px; letter-spacing:.3px}
    .sub{color:var(--muted); font-size:13px; margin:0}
    .controls{
      display:grid; grid-template-columns: 1.2fr .8fr .6fr .6fr; gap:10px;
      margin-top:14px;
    }
    input, select, button{
      width:100%; padding:10px 12px; border-radius:12px;
      border:1px solid var(--border); background:#0e1730; color:var(--text);
      outline:none;
    }
    button{cursor:pointer; font-weight:600; background:linear-gradient(90deg,#1b6dff,#3aa8ff); border:none;}
    button.secondary{background:#0e1730; border:1px solid var(--border); font-weight:600;}
    main .wrap{padding-top:14px}
    .meta{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin:8px 0 14px; color:var(--muted); font-size:13px;
    }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px; border-radius:999px; background:rgba(26,39,69,.65);
      border:1px solid var(--border);
    }
    .grid{display:grid; grid-template-columns: repeat(3, 1fr); gap:12px;}
    @media (max-width: 980px){ .controls{grid-template-columns:1fr 1fr; } .grid{grid-template-columns:1fr 1fr;} }
    @media (max-width: 640px){ .controls{grid-template-columns:1fr; } .grid{grid-template-columns:1fr;} }
    .card{
      background:linear-gradient(180deg, rgba(17,26,46,.95), rgba(13,20,38,.95));
      border:1px solid var(--border);
      border-radius:18px; padding:14px;
      box-shadow: 0 10px 24px rgba(0,0,0,.28);
      display:flex; flex-direction:column; gap:10px;
      min-height: 210px;
    }
    .topline{display:flex; justify-content:space-between; gap:10px; align-items:flex-start;}
    .name{font-size:16px; margin:0; line-height:1.2;}
    .code{
      font-size:12px; color:var(--muted); padding:4px 8px; border-radius:999px;
      background:rgba(26,39,69,.8); border:1px solid var(--border); white-space:nowrap;
    }
    .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip{
      font-size:12px; color:#cfe3ff; background:rgba(26,39,69,.8);
      border:1px solid var(--border); padding:5px 8px; border-radius:999px;
    }
    .desc{margin:0; color:#d7e4ff; font-size:13px; line-height:1.35}
    .muted{color:var(--muted)}
    .actions{margin-top:auto; display:flex; gap:10px; flex-wrap:wrap}
    .link{
      display:inline-flex; align-items:center; justify-content:center;
      padding:9px 10px; border-radius:12px; border:1px solid var(--border);
      background:#0e1730; color:var(--text); text-decoration:none; font-weight:600; font-size:13px; flex:1;
    }
    .link.primary{background:rgba(37, 211, 102,.12); border:1px solid rgba(37, 211, 102,.35); color:#caffdd;}
    .catTitle{
      margin:18px 0 10px; font-size:14px; color:#d9e8ff;
      display:flex; align-items:center; gap:10px;
    }
    .catTitle span{
      padding:6px 10px; border-radius:999px; background:rgba(74,163,255,.12);
      border:1px solid rgba(74,163,255,.28); color:#cfe6ff; font-weight:700;
    }
    .empty{
      padding:18px; border-radius:18px; border:1px dashed var(--border);
      background:rgba(17,26,46,.35); color:var(--muted);
    }
    .footer{
      color:var(--muted); font-size:12px; padding:22px 16px; text-align:center;
      border-top:1px solid var(--border); margin-top:22px;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size:12px; padding:2px 6px; border-radius:8px;
      border:1px solid var(--border); background:#0e1730; color:#cfe3ff;
    }
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <h1>Cat√°logo Integral ALPACEL <span style="font-weight:600;color:#9fb0d0; font-size:13px;">¬∑ Hecho por Lic. Cecilia Avila</span></h1>
    <p class="sub">Capacitaci√≥n efectiva: lo que se ordena, se entiende; lo que se entiende, se vende con confianza. ‚ú®</p>

    <div class="controls">
      <input id="q" type="search" placeholder="Buscar por nombre, sustancia, uso‚Ä¶ (ej. 'diarrea', 'paracetamol')" />
      <select id="cat"></select>
      <select id="sort">
        <option value="az">Orden: A ‚Üí Z</option>
        <option value="za">Orden: Z ‚Üí A</option>
      </select>
      <button id="reset" class="secondary" type="button">Limpiar filtros</button>
    </div>

    <div class="meta">
      <div class="pill">Total: <strong id="count">0</strong> productos</div>
      <div class="pill">Tip: <span class="kbd">Ctrl</span> + <span class="kbd">F</span> tambi√©n funciona (pero aqu√≠ filtras por categor√≠a).</div>
    
    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
      <button onclick="downloadSelf()" title="Descargar este cat√°logo">‚¨áÔ∏è Descargar cat√°logo</button>
      <button class="secondary" onclick="exportCSV()" title="Exportar productos a CSV">üìÑ Exportar CSV</button>
      <button class="secondary" onclick="openQuiz()" title="Preguntas r√°pidas de capacitaci√≥n">üß† Preguntas r√°pidas</button>
    </div>

</div>
  </div>
</header>

<main>
  <div class="wrap" id="out"></div>
</main>


<div id="quizModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:99;">
  <div style="background:#0e1730; max-width:620px; margin:6% auto; padding:20px; border-radius:18px; border:1px solid #243556;">
    <h2 style="margin-top:0">üß† Preguntas r√°pidas de capacitaci√≥n</h2>
    <p class="muted">R√°pido y al punto: si dominas esto, dominas la recomendaci√≥n.</p>
    <div id="quizContent"></div>
    <div style="display:flex; gap:10px; margin-top:14px;">
      <button onclick="nextQuiz()">Siguiente</button>
      <button class="secondary" onclick="closeQuiz()">Cerrar</button>
    </div>
  </div>
</div>

<div class="footer">
  Uso interno (capacitaci√≥n). Hecho por <strong>Lic. Cecilia Avila</strong>. Para agregar productos: edita el arreglo <span class="kbd">PRODUCTOS</span> dentro del archivo.
</div>

<script>
const PRODUCTOS = [
  // --- Del documento "fichas 3" (ejemplos) ---
  { nombre:"Flemigor", categoria:"Respiratorio: tos y gripe", sustancia:"Guaifenesina + Fenilefrina + Dextrometorfano", presentacion:"Soluci√≥n", para:"Tos con flemas y congesti√≥n nasal (auxiliar)", codigo:"2552 / 2553", pagina:"(fichas 3) 1-2" },
  { nombre:"Acetilciste√≠na", categoria:"Respiratorio: tos y gripe", sustancia:"Acetilciste√≠na", presentacion:"Tabletas efervescentes", para:"Expectorante (auxiliar)", codigo:"2731", pagina:"(fichas 3) 16" },
  { nombre:"Cloruro de sodio (soluci√≥n nasal)", categoria:"Respiratorio: nariz y congesti√≥n", sustancia:"Cloruro de sodio", presentacion:"Soluci√≥n / spray nasal", para:"Humecta fosas nasales (auxiliar)", codigo:"2935", pagina:"(fichas 3) 38" },
  { nombre:"Fexofenadina", categoria:"Alergias", sustancia:"Fexofenadina", presentacion:"Comprimidos", para:"Rinitis/urticaria (auxiliar)", codigo:"2665", pagina:"(fichas 3) 6" },
  { nombre:"Nifuroxazida (suspensi√≥n)", categoria:"Gastro: diarrea", sustancia:"Nifuroxazida", presentacion:"Suspensi√≥n", para:"Diarrea (auxiliar)", codigo:"2675", pagina:"(fichas 3) 8" },
  { nombre:"Nifuroxazida 400 mg", categoria:"Gastro: diarrea", sustancia:"Nifuroxazida", presentacion:"C√°psulas 400 mg", para:"Diarrea (auxiliar)", codigo:"2740", pagina:"(fichas 3) 19" },
  { nombre:"Subsalicilato de bismuto (PLUS)", categoria:"Gastro: diarrea / malestar estomacal", sustancia:"Subsalicilato de bismuto", presentacion:"Suspensi√≥n PLUS", para:"Diarrea/indigesti√≥n (auxiliar)", codigo:"2998", pagina:"(fichas 3) 41" },
  { nombre:"Sal de uvas Picot", categoria:"Gastro: agruras / indigesti√≥n", sustancia:"Bicarbonato de sodio + √Åcido c√≠trico + √Åcido tart√°rico", presentacion:"Sobres efervescentes", para:"Acidez/agruras (auxiliar)", codigo:"3153", pagina:"(fichas 3) 47" },
  { nombre:"Paracetamol 650", categoria:"Dolor y fiebre", sustancia:"Paracetamol 650 mg", presentacion:"Tabletas", para:"Dolor y fiebre (auxiliar)", codigo:"2788", pagina:"(fichas 3) 20" },
  { nombre:"Paracetamol + ASA + Cafe√≠na", categoria:"Dolor y fiebre", sustancia:"Paracetamol + √Åcido acetilsalic√≠lico + Cafe√≠na", presentacion:"Tabletas", para:"Dolor de cabeza/migra√±a (auxiliar)", codigo:"2677", pagina:"(fichas 3) 9" },
  { nombre:"Permetrina", categoria:"Piel: pediculosis", sustancia:"Permetrina 5%", presentacion:"Soluci√≥n / shampoo", para:"Piojos/liendres (auxiliar)", codigo:"2678", pagina:"(fichas 3) 10" },
  { nombre:"Medipiox", categoria:"Piel: pediculosis", sustancia:"Dimeticona + ciclopentasiloxano (seg√∫n ficha)", presentacion:"Soluci√≥n", para:"Piojos/liendres (auxiliar)", codigo:"2733", pagina:"(fichas 3) 17" },
  { nombre:"Matricaria recutita", categoria:"Oft√°lmico", sustancia:"Extracto de Matricaria recutita (manzanilla)", presentacion:"Soluci√≥n oft√°lmica", para:"Limpieza/descanso de ojos (auxiliar)", codigo:"2700", pagina:"(fichas 3) 13" },
  { nombre:"Forze VF G+G", categoria:"Vitaminas y rendimiento", sustancia:"Multivitam√≠nico con ginkgo biloba y ginseng (seg√∫n ficha)", presentacion:"C√°psulas", para:"Memoria/concentraci√≥n (auxiliar)", codigo:"2670", pagina:"(fichas 3) 7" },
  { nombre:"Simi VF Krill", categoria:"Vitaminas y coraz√≥n", sustancia:"Omega 3 (krill) (seg√∫n ficha)", presentacion:"C√°psulas", para:"Cuerpo y coraz√≥n (auxiliar)", codigo:"2739", pagina:"(fichas 3) 18" },
  { nombre:"Simipz + Valeriana", categoria:"Sue√±o y ansiedad", sustancia:"Valeriana officinalis (seg√∫n ficha)", presentacion:"C√°psulas", para:"Ansiedad/sue√±o (auxiliar)", codigo:"2790", pagina:"(fichas 3) 21" },

  // --- Del documento "fichas 1" (agregado) ---
  { nombre:"Paracetamol 500 mg", categoria:"Dolor y fiebre", sustancia:"Paracetamol 500 mg", presentacion:"Tabletas", para:"Alivia dolor y fiebre sin irritar el est√≥mago", codigo:"162", pagina:"(fichas 1) 1" },
  { nombre:"√Åcido acetilsalic√≠lico", categoria:"Dolor y fiebre", sustancia:"√Åcido acetilsalic√≠lico 500 mg", presentacion:"Tabletas", para:"Alivio r√°pido y eficaz del dolor", codigo:"7", pagina:"(fichas 1) 4" },
  { nombre:"Naproxeno s√≥dico 275 mg", categoria:"Dolor e inflamaci√≥n", sustancia:"Naproxeno s√≥dico 275 mg", presentacion:"Tabletas", para:"Ayuda a disminuir y aliviar diferentes tipos de dolor", codigo:"147", pagina:"(fichas 1) 18" },
  { nombre:"Naproxeno + Paracetamol (suspensi√≥n)", categoria:"Dolor e inflamaci√≥n (pediatr√≠a)", sustancia:"Naproxeno s√≥dico + Paracetamol", presentacion:"Suspensi√≥n", para:"Alivia dolor e inflamaci√≥n y baja la fiebre en ni√±os", codigo:"151", pagina:"(fichas 1) 19" },
  { nombre:"Naproxeno + Paracetamol (tabletas)", categoria:"Dolor e inflamaci√≥n", sustancia:"Naproxeno s√≥dico + Paracetamol", presentacion:"Tabletas", para:"Alivia dolor e inflamaci√≥n y baja la fiebre", codigo:"152", pagina:"(fichas 1) 20" },

  { nombre:"Dextrometorfano + Ambroxol", categoria:"Respiratorio: tos y flemas", sustancia:"Dextrometorfano + Ambroxol", presentacion:"Jarabe", para:"Ayuda a eliminar tos y flemas", codigo:"19", pagina:"(fichas 1) 7" },
  { nombre:"Paracetamol + Cafe√≠na + Fenilefrina + Clorfenamina", categoria:"Respiratorio: antigripal", sustancia:"Paracetamol + Cafe√≠na + Fenilefrina + Clorfenamina", presentacion:"Tabletas", para:"Combate s√≠ntomas de gripe durante todo el d√≠a", codigo:"68", pagina:"(fichas 1) 9" },
  { nombre:"Vitaminas A, D y C (gotas infantiles)", categoria:"Respiratorio: prevenci√≥n infantil", sustancia:"Vitamina A + D2 + C", presentacion:"Soluci√≥n infantil en gotas", para:"Auxiliar en prevenci√≥n y tratamiento de gripe en ni√±os", codigo:"270", pagina:"(fichas 1) 26" },
  { nombre:"Palmitato de retinol + Ergocalciferol (ampolletas)", categoria:"Respiratorio: prevenci√≥n (A y D)", sustancia:"Vitamina A (retinol) + Vitamina D2 (ergocalciferol)", presentacion:"Ampolletas (soluci√≥n)", para:"Auxiliar en prevenci√≥n de gripe y resfriado com√∫n", codigo:"831", pagina:"(fichas 1) 85" },

  { nombre:"Clotrimazol", categoria:"Antimic√≥tico (vaginal)", sustancia:"Clotrimazol 2 g (seg√∫n ficha)", presentacion:"Crema", para:"Alivia s√≠ntomas de infecciones vaginales", codigo:"72", pagina:"(fichas 1) 10" },
  { nombre:"Ketoconazol", categoria:"Antimic√≥tico (piel)", sustancia:"Ketoconazol 2 g/100 g (seg√∫n ficha)", presentacion:"Crema", para:"Infecciones por hongos en piel", codigo:"123", pagina:"(fichas 1) 13" },
  { nombre:"Ketoconazol", categoria:"Antimic√≥tico (cuero cabelludo)", sustancia:"Ketoconazol 2 g/100 ml (seg√∫n ficha)", presentacion:"Shampoo", para:"Ayuda a eliminar la caspa", codigo:"124", pagina:"(fichas 1) 14" },
  { nombre:"Miconazol", categoria:"Antimic√≥tico (piel)", sustancia:"Miconazol 2 g/100 g (seg√∫n ficha)", presentacion:"Crema", para:"Combate hongos de la piel", codigo:"145", pagina:"(fichas 1) 17" },
  { nombre:"Aciclovir", categoria:"Antiviral (piel)", sustancia:"Aciclovir 50 mg por gramo (seg√∫n ficha)", presentacion:"Crema", para:"Previene y controla s√≠ntomas del fuego labial", codigo:"5", pagina:"(fichas 1) 3" },

  { nombre:"Diclofenaco", categoria:"Dolor e inflamaci√≥n (t√≥pico)", sustancia:"Diclofenaco 1.16 g/100 g (seg√∫n ficha)", presentacion:"Gel", para:"Eficaz analg√©sico y antiinflamatorio local", codigo:"80", pagina:"(fichas 1) 11" },
  { nombre:"Bencidamina", categoria:"Dolor e inflamaci√≥n (t√≥pico)", sustancia:"Bencidamina 5 g/100 ml (seg√∫n ficha)", presentacion:"Gel", para:"R√°pido alivio de dolor e inflamaci√≥n muscular leve", codigo:"40", pagina:"(fichas 1) 8" },
  { nombre:"Dracaena + √Årnica + Alcanfor + Eucalipto", categoria:"Dolor e inflamaci√≥n (t√≥pico natural)", sustancia:"Dracaena, √°rnica, alcanfor, mentol, eucalipto (seg√∫n ficha)", presentacion:"Gel t√©rmico", para:"Gel t√©rmico natural para dolor e inflamaci√≥n", codigo:"3117", pagina:"(fichas 1) 6" },

  { nombre:"Nafazolina + Feniramina", categoria:"Oft√°lmico", sustancia:"Nafazolina + Feniramina (seg√∫n ficha)", presentacion:"Soluci√≥n oft√°lmica", para:"Alivia enrojecimiento de los ojos", codigo:"101", pagina:"(fichas 1) 12" },

  { nombre:"Loperamida", categoria:"Gastro: diarrea", sustancia:"Clorhidrato de loperamida 2 mg (seg√∫n ficha)", presentacion:"Tabletas", para:"Ayuda a reducir el n√∫mero de evacuaciones", codigo:"128", pagina:"(fichas 1) 15" },
  { nombre:"Neomicina + Caol√≠n + Pectina", categoria:"Gastro: diarrea", sustancia:"Neomicina + Caol√≠n + Pectina (seg√∫n ficha)", presentacion:"Suspensi√≥n", para:"Control de diarrea infecciosa y no infecciosa", codigo:"848", pagina:"(fichas 1) 86" },
  { nombre:"Sen√≥sidos A y B (c√°psulas)", categoria:"Gastro: estre√±imiento", sustancia:"Sen√≥sidos A y B 12 mg + ciruela 25 mg (seg√∫n ficha)", presentacion:"C√°psulas", para:"Mejora tr√°nsito intestinal y alivia estre√±imiento", codigo:"329", pagina:"(fichas 1) 31" },
  { nombre:"Sen√≥sidos A y B (tabletas)", categoria:"Gastro: estre√±imiento", sustancia:"Sen√≥sidos A y B 8.6 mg (seg√∫n ficha)", presentacion:"Tabletas", para:"Laxante vegetal para estre√±imiento", codigo:"630", pagina:"(fichas 1) 62" },
  { nombre:"Mebendazol", categoria:"Antiparasitario", sustancia:"Mebendazol 100 mg (seg√∫n ficha)", presentacion:"Tabletas", para:"Elimina par√°sitos intestinales", codigo:"130", pagina:"(fichas 1) 16" },

  { nombre:"Vitamina E 400 mg", categoria:"Vitaminas y piel", sustancia:"Vitamina E 400 mg", presentacion:"C√°psulas (90)", para:"Acci√≥n antioxidante; mejora apariencia de la piel", codigo:"188", pagina:"(fichas 1) 5" },
  { nombre:"Ajo deodorizado Dr. Simi", categoria:"Circulaci√≥n", sustancia:"Concentrado de ajo 310 mg (seg√∫n ficha)", presentacion:"C√°psulas", para:"Ayuda a mejorar la circulaci√≥n", codigo:"735", pagina:"(fichas 1) 73" },

  { nombre:"Crema humectante para tatuajes", categoria:"Cuidado personal: piel", sustancia:"D-pantenol + manteca de karit√© + alanto√≠na + hamamelis + s√°bila + jojoba + vit. E/A (seg√∫n ficha)", presentacion:"Crema", para:"Hidrata y repara piel tatuada; realza color", codigo:"3285", pagina:"(fichas 1) 2" },
// --- Del documento "fichas 2" (agregado) ---
  { nombre:"Simiflex Plus", categoria:"Articulaciones: movilidad", sustancia:"Glucosamina + Condroitina + Gelatina", presentacion:"C√°psulas", para:"Mejora movilidad y flexibilidad articular (auxiliar)", codigo:"1178 / 1868", pagina:"(fichas 2) 1" },
  { nombre:"Tiraleche", categoria:"Beb√© y lactancia", sustancia:"Recolector de leche materna (dispositivo)", presentacion:"Accesorio", para:"Recolecci√≥n econ√≥mica de leche materna", codigo:"1189", pagina:"(fichas 2) 2" },
  { nombre:"Simicof", categoria:"Respiratorio: tos", sustancia:"Hedera helix + Bugambilia + Miel (seg√∫n ficha)", presentacion:"Jarabe", para:"Alivio natural para tos seca o con flemas (auxiliar)", codigo:"1265", pagina:"(fichas 2) 3" },
  { nombre:"√Åcido f√≥lico y hierro", categoria:"Embarazo y prenatal", sustancia:"√Åcido f√≥lico + Hierro", presentacion:"Tabletas", para:"Apoyo prenatal; sistema nervioso del beb√© (auxiliar)", codigo:"1267", pagina:"(fichas 2) 4" },
  { nombre:"Gel antiacn√© Simiseptic", categoria:"Piel: acn√©", sustancia:"(seg√∫n ficha) mezcla con √°cido salic√≠lico, hamamelis, cal√©ndula, etc.", presentacion:"Gel", para:"Reduce acn√©, barros y espinillas (auxiliar)", codigo:"1278", pagina:"(fichas 2) 5" },
  { nombre:"Simisure", categoria:"Nutrici√≥n: complemento", sustancia:"F√≥rmula nutricional (seg√∫n ficha)", presentacion:"Polvo (fresa, vainilla, chocolate)", para:"Nutrici√≥n completa (auxiliar)", codigo:"1280 / 1282 / 1868", pagina:"(fichas 2) 6" },
  { nombre:"Simialoe", categoria:"Gastro: gastritis", sustancia:"Aloe vera (s√°bila) (seg√∫n ficha)", presentacion:"Jugo", para:"Auxiliar natural en gastritis y √∫lceras", codigo:"1308", pagina:"(fichas 2) 7" },
  { nombre:"Exaliv (antigripal noche)", categoria:"Respiratorio: antigripal", sustancia:"Paracetamol + Fenilefrina + Clorfenamina", presentacion:"Tabletas", para:"Combate s√≠ntomas de gripe durante la noche (auxiliar)", codigo:"1326", pagina:"(fichas 2) 8" },
  { nombre:"Simi B con hierro y zinc", categoria:"Vitaminas y energ√≠a", sustancia:"Complejo B + Hierro + Zinc (seg√∫n ficha)", presentacion:"C√°psulas", para:"Sistema nervioso y energ√≠a (auxiliar)", codigo:"1346", pagina:"(fichas 2) 9" },
  { nombre:"Jeringa pera N.¬∞ 0 y N.¬∞ 3", categoria:"Beb√©: higiene nasal", sustancia:"Jeringa de succi√≥n (dispositivo)", presentacion:"Accesorio", para:"Limpia y descongestiona nariz del beb√©", codigo:"1445 / 1396", pagina:"(fichas 2) 10" },
  { nombre:"Bencidamina", categoria:"Boca y garganta", sustancia:"Clorhidrato de bencidamina (seg√∫n ficha)", presentacion:"Soluci√≥n 360 ml", para:"Alivio en molestias de boca y garganta (auxiliar)", codigo:"1440", pagina:"(fichas 2) 11" },
  { nombre:"Picosulfato de sodio", categoria:"Gastro: estre√±imiento", sustancia:"Picosulfato de sodio 7.5 mg (seg√∫n ficha)", presentacion:"Soluci√≥n gotas", para:"Auxiliar en estre√±imiento (ni√±os, seg√∫n dosis)", codigo:"1447", pagina:"(fichas 2) 12" },
  { nombre:"√Åcido asc√≥rbico efervescente 2 g", categoria:"Defensas y resfriado", sustancia:"Vitamina C (√°cido asc√≥rbico) 2 g", presentacion:"Comprimidos efervescentes", para:"Ayuda a tratar/proteger en gripe; aumenta defensas (auxiliar)", codigo:"1450", pagina:"(fichas 2) 13" },
  { nombre:"Crema Simidiab", categoria:"Cuidado personal: diabetes", sustancia:"(seg√∫n ficha) humectantes y extractos", presentacion:"Crema", para:"Humecta piel/pies/manos en personas con diabetes (auxiliar)", codigo:"1460", pagina:"(fichas 2) 14" },
  { nombre:"Crema para v√°rices y piernas cansadas", categoria:"Circulaci√≥n: piernas", sustancia:"(seg√∫n ficha) elastasa, √°rnica, casta√±o de indias, etc.", presentacion:"Crema", para:"Piernas cansadas; apoyo en embarazo/circulaci√≥n (auxiliar)", codigo:"1481", pagina:"(fichas 2) 16" },
  { nombre:"Aceclofenaco", categoria:"Dolor e inflamaci√≥n (t√≥pico)", sustancia:"Aceclofenaco 1.5 g/100 g", presentacion:"Crema", para:"Alivia dolor localizado por m√°s tiempo sin irritar piel (auxiliar)", codigo:"1496", pagina:"(fichas 2) 17" },
  { nombre:"Similess Caf√©", categoria:"Control de peso", sustancia:"Caf√© + cromo + vitaminas (seg√∫n ficha)", presentacion:"Bebida", para:"Auxiliar para control de peso con dieta y ejercicio", codigo:"1507", pagina:"(fichas 2) 18" },
  { nombre:"Floroglucinol", categoria:"Beb√©: c√≥lico", sustancia:"Floroglucinol 29 mg (seg√∫n ficha)", presentacion:"Soluci√≥n gotas (lim√≥n)", para:"Alivio eficaz del c√≥lico infantil (auxiliar)", codigo:"1545", pagina:"(fichas 2) 19" },
  { nombre:"Simisure D", categoria:"Nutrici√≥n: diabetes", sustancia:"F√≥rmula nutricional para diabetes (seg√∫n ficha)", presentacion:"Polvo (chocolate, fresa, vainilla)", para:"Asegura aporte nutricional en personas con diabetes", codigo:"1564 / 1867 / 1563", pagina:"(fichas 2) 20" },
  { nombre:"Pantoprazol (liberaci√≥n retardada)", categoria:"Gastro: reflujo / gastritis", sustancia:"Pantoprazol 20 mg", presentacion:"Tabletas liberaci√≥n retardada", para:"Control de acidez, reflujo y cicatrizaci√≥n (auxiliar)", codigo:"1590", pagina:"(fichas 2) 23" },
  { nombre:"Magaldrato + Dimeticona (gel)", categoria:"Gastro: acidez y gases", sustancia:"Magaldrato 80 mg/ml + Dimeticona 10 mg/ml", presentacion:"Gel / sobres", para:"Alivio r√°pido y prolongado de acidez, reflujo y gases (auxiliar)", codigo:"1797 / 2276", pagina:"(fichas 2) 35" },
  { nombre:"Guayaba + Linaza", categoria:"Gastro: colitis y c√≥licos", sustancia:"Extracto hoja guayaba + Aceite de linaza", presentacion:"C√°psulas", para:"Antiespasm√≥dico natural para colitis y c√≥lico menstrual (auxiliar)", codigo:"1973 / 2391", pagina:"(fichas 2) 51-52" },
  { nombre:"Simi Probacilus", categoria:"Gastro: flora intestinal", sustancia:"Lactobacillus sporogenes + sorbitol (seg√∫n ficha)", presentacion:"Tabletas masticables", para:"Ayuda a aliviar estre√±imiento y mantener flora (auxiliar)", codigo:"1976 / 2043", pagina:"(fichas 2) 55" },
  { nombre:"Simiwell", categoria:"Defensas y resfriado", sustancia:"Betaglucano (Wellmune) + Vitamina C + Zinc", presentacion:"Gomitas", para:"Activa defensas y apoya recuperaci√≥n respiratoria (auxiliar)", codigo:"2041", pagina:"(fichas 2) 63" },
  { nombre:"Esencias Naturales (spray)", categoria:"Sue√±o y relajaci√≥n", sustancia:"Aceites esenciales (melisa, pasiflora, lavanda, etc.)", presentacion:"Spray", para:"Aroma que ayuda a conciliar el sue√±o (auxiliar)", codigo:"2076", pagina:"(fichas 2) 64" },
  { nombre:"Pinaverio + Dimeticona", categoria:"Gastro: colitis", sustancia:"Pinaverio 100 mg + Dimeticona 300 mg", presentacion:"C√°psulas", para:"Triple acci√≥n contra s√≠ntomas de colitis (auxiliar)", codigo:"2342", pagina:"(fichas 2) 87" },
  { nombre:"La Femme", categoria:"Salud femenina: climaterio", sustancia:"Cimicifuga racemosa + Glycine max + pasiflora + vitaminas (seg√∫n ficha)", presentacion:"C√°psulas (30)", para:"Auxiliar en s√≠ntomas de menopausia/climaterio (no hormonal)", codigo:"2352", pagina:"(fichas 2) 88" },
  { nombre:"Desmaquillante bif√°sico", categoria:"Cuidado personal: rostro", sustancia:"Fase acuosa + oleosa (seg√∫n ficha)", presentacion:"L√≠quido", para:"Elimina maquillaje a prueba de agua (ojos y labios)", codigo:"2106", pagina:"(fichas 2) 66" },
  { nombre:"Crema antiarrugas 40+ FPS 15", categoria:"Cuidado personal: rostro", sustancia:"Trylagen (p√©ptidos/prote√≠nas) (seg√∫n ficha)", presentacion:"Crema", para:"Nutre, suaviza y da firmeza; disminuye arrugas (auxiliar)", codigo:"2183", pagina:"(fichas 2) 71" },
  { nombre:"Crema blanqueadora y desmanchadora", categoria:"Cuidado personal: rostro", sustancia:"C√©lulas madre vegetales + chromabright (seg√∫n ficha)", presentacion:"Crema", para:"Unifica tono y desvanece manchas (auxiliar)", codigo:"2184", pagina:"(fichas 2) 72" },
  { nombre:"S√©rum dermo renovador", categoria:"Cuidado personal: rostro", sustancia:"Col√°geno hidrolizado (seg√∫n ficha)", presentacion:"S√©rum", para:"Renueva y da firmeza; disminuye l√≠neas de expresi√≥n", codigo:"2185", pagina:"(fichas 2) 73" },
  { nombre:"BB Cream FPS 30 (tono medio)", categoria:"Cuidado personal: rostro", sustancia:"BB cream con color + FPS 30 (seg√∫n ficha)", presentacion:"Crema con color", para:"Hidrata, protege y unifica la piel", codigo:"2251", pagina:"(fichas 2) 78" },
  { nombre:"BB Cream FPS 30 (tono claro)", categoria:"Cuidado personal: rostro", sustancia:"BB cream con color + FPS 30 (seg√∫n ficha)", presentacion:"Crema con color", para:"Hidrata, protege y unifica la piel", codigo:"2497", pagina:"(fichas 2) 100" },
  { nombre:"Tonificante dermo oxigenador", categoria:"Cuidado personal: rostro", sustancia:"Agua de rosas + hamamelis (seg√∫n ficha)", presentacion:"Tonificante", para:"Regula pH, limpia poros y remueve exceso de grasa", codigo:"2267", pagina:"(fichas 2) 81" },
  { nombre:"Exfoliante facial", categoria:"Cuidado personal: rostro", sustancia:"Vitamina E + enebro + bardana (seg√∫n ficha)", presentacion:"Exfoliante", para:"Elimina c√©lulas muertas y puntos negros; suaviza piel", codigo:"2292", pagina:"(fichas 2) 83" },
  { nombre:"Dermo reparador antioxidante (crema)", categoria:"Cuidado personal: rostro", sustancia:"Astaxantina (seg√∫n ficha)", presentacion:"Crema", para:"Repara da√±os ambientales y aporta luminosidad", codigo:"2376", pagina:"(fichas 2) 89" },
  { nombre:"Dermo reparador antioxidante (c√°psulas)", categoria:"Cuidado personal: suplementos", sustancia:"Col√°geno hidrolizado + Astaxantina 10% (seg√∫n ficha)", presentacion:"C√°psulas", para:"Antioxidante; ayuda a u√±as, cabello y piel (auxiliar)", codigo:"2451", pagina:"(fichas 2) 97" },
  { nombre:"CLA X-Gear", categoria:"Deportistas: definici√≥n", sustancia:"√Åcido linoleico conjugado (CLA) 1 g por c√°psula", presentacion:"C√°psulas", para:"Auxiliar para reducir grasa con ejercicio moderado", codigo:"(seg√∫n ficha)", pagina:"(fichas 2) 98" },
  { nombre:"Sen√≥sidos A y B + concentrado de ciruela", categoria:"Gastro: estre√±imiento", sustancia:"Sen√≥sidos A-B 12 mg + ciruela 50 mg (por perla)", presentacion:"Perlas", para:"Mejora tr√°nsito intestinal y alivia estre√±imiento (auxiliar)", codigo:"2442", pagina:"(fichas 2) 95" },
// --- Del documento "fichas 4" (agregado) ---
  { nombre:"Acelerador de bronceado FPS 30 Eternal Secret", categoria:"Cuidado personal: solar (Eternal Secret)", sustancia:"(Cosm√©tico) FPS 30", presentacion:"Crema / loci√≥n corporal", para:"Acelera e intensifica el bronceado; reduce da√±o por UVA/UVB", codigo:"3529", pagina:"(fichas 4) p.1" },
  { nombre:"Protector solar Eco Friendly", categoria:"Cuidado personal: solar (Eternal Secret)", sustancia:"(Cosm√©tico) protector solar", presentacion:"Protector solar", para:"Previene quemaduras, manchas y envejecimiento prematuro (uso familiar)", codigo:"3530", pagina:"(fichas 4) p.2" },
  { nombre:"Gomitas de CBD sabor frutos rojos", categoria:"Bienestar: relajaci√≥n (CBD)", sustancia:"CBD 2.5 mg + Vitamina C 60 mg + Vitamina D 400 UI + Vitamina B12 2 mcg (por gomita)", presentacion:"30 gomitas", para:"Disminuyen el estr√©s leve y producen efecto relajante sin efectos psicoactivos", codigo:"(ver ficha)", pagina:"(fichas 4) p.49", notas:"Dosis: 1 gomita antes de dormir. Contraindicaciones: hipersensibilidad; diabetes; embarazo o lactancia." },
  { nombre:"Paracetamol jarabe infantil sabor fresa", categoria:"Dolor y fiebre (pediatr√≠a)", sustancia:"Paracetamol (seg√∫n ficha)", presentacion:"Jarabe", para:"Auxiliar en resfriado com√∫n; disminuye dolor y fiebre", codigo:"(ver ficha)", pagina:"(fichas 4) p.48", notas:"Cada 4‚Äì6 h por no m√°s de 3 d√≠as. (Dosis por edad indicada en ficha)." },
  { nombre:"SOD Suero antioxidante", categoria:"Cuidado personal: dermo (Eternal Secret)", sustancia:"Super√≥xido dismutasa + extracto de alga + amino√°cidos + ceramidas (seg√∫n ficha)", presentacion:"S√©rum", para:"Poderoso antioxidante t√≥pico; previene envejecimiento prematuro", codigo:"3763", pagina:"(fichas 4) p.52" },
  { nombre:"Hierro/√Åcido f√≥lico 90 mg / 1000 mcg (SimiBaby)", categoria:"Embarazo y prenatal", sustancia:"Hierro + √Åcido f√≥lico", presentacion:"30 tabletas", para:"Tratamiento y prevenci√≥n de deficiencia de √°cido f√≥lico y hierro en gestaci√≥n, lactancia y puerperio", codigo:"3783", pagina:"(fichas 4) p.55" }


];

// ---------- l√≥gica UI ----------
const $ = (s)=>document.querySelector(s);
const out = $("#out");
const q = $("#q");
const cat = $("#cat");
const sort = $("#sort");
const reset = $("#reset");
const count = $("#count");

function normaliza(t){
  return (t||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();
}

function buildCategorias(){
  const categorias = ["Todas"].concat(
    Array.from(new Set(PRODUCTOS.map(p=>p.categoria))).sort((a,b)=>a.localeCompare(b,"es"))
  );
  cat.innerHTML = categorias.map(c=>`<option value="${c}">${c}</option>`).join("");
}

function filtra(){
  const texto = normaliza(q.value);
  const categoria = cat.value;
  let list = [...PRODUCTOS];

  if(categoria && categoria !== "Todas") list = list.filter(p => p.categoria === categoria);

  if(texto){
    list = list.filter(p=>{
      const blob = normaliza([p.nombre,p.categoria,p.sustancia,p.presentacion,p.para,p.codigo,p.notas,p.pagina].filter(Boolean).join(" | "));
      return blob.includes(texto);
    });
  }

  list.sort((a,b)=>{
    const A = a.nombre.localeCompare(b.nombre,"es");
    return sort.value === "az" ? A : -A;
  });

  render(list);
}

function groupByCategoria(list){
  const map = new Map();
  for(const p of list){
    if(!map.has(p.categoria)) map.set(p.categoria, []);
    map.get(p.categoria).push(p);
  }
  return Array.from(map.entries()).sort((a,b)=>a[0].localeCompare(b[0],"es"));
}

function escapeHtml(s){
  return (s||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")
    .replace(/"/g,"&quot;").replace(/'/g,"&#039;");
}

function card(p){
  const chips = [
    p.presentacion ? `<span class="chip">${escapeHtml(p.presentacion)}</span>` : "",
    p.sustancia ? `<span class="chip">${escapeHtml(p.sustancia)}</span>` : "",
    p.para ? `<span class="chip">Uso: ${escapeHtml(p.para)}</span>` : "",
  ].filter(Boolean).join("");

  const extras = [
    p.notas ? `<div class="desc muted"><strong>Nota:</strong> ${escapeHtml(p.notas)}</div>` : "",
    p.pagina ? `<div class="desc muted">üìÑ Referencia: ${escapeHtml(p.pagina)}</div>` : ""
  ].filter(Boolean).join("");

  return `
    <div class="card">
      <div class="topline">
        <h3 class="name">${escapeHtml(p.nombre)}</h3>
        ${p.codigo ? `<div class="code">C√≥d. ${escapeHtml(p.codigo)}</div>` : `<div class="code">‚Äî</div>`}
      </div>

      <div class="chips">${chips || `<span class="chip">Sin detalles extra (a√∫n)</span>`}</div>

      ${extras}

      <div class="actions">
        <a class="link primary" href="#" onclick="copiar('${escapeHtml(p.nombre)}'); return false;">Copiar nombre</a>
        <a class="link" href="#" onclick="copiar('${escapeHtml(p.sustancia || "")}'); return false;">Copiar sustancia</a>
      </div>
    </div>
  `;
}

function render(list){
  count.textContent = String(list.length);

  if(!list.length){
    out.innerHTML = `<div class="empty">No hay coincidencias. Cambia el filtro o busca con otra palabra.</div>`;
    return;
  }

  const grouped = groupByCategoria(list);

  out.innerHTML = grouped.map(([categoria, items])=>{
    return `
      <div class="catTitle"><span>${escapeHtml(categoria)}</span> <span class="muted">${items.length} √≠tems</span></div>
      <div class="grid">
        ${items.map(card).join("")}
      </div>
    `;
  }).join("");
}

function copiar(txt){
  if(!txt){ alert("No hay texto que copiar en este campo üòÖ"); return; }
  navigator.clipboard.writeText(txt).catch(()=> alert("No se pudo copiar. Intenta manualmente."));
}

reset.addEventListener("click", ()=>{
  q.value = "";
  cat.value = "Todas";
  sort.value = "az";
  filtra();
});

[q, cat, sort].forEach(el=>el.addEventListener("input", filtra));

buildCategorias();
filtra();

function downloadSelf(){
  const blob = new Blob([document.documentElement.outerHTML], {type: 'text/html;charset=utf-8'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'Catalogo_Integral_ALPACEL.html';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

function exportCSV(){
  const headers = ["Nombre","Categoria","Sustancia","Presentacion","Uso","Codigo","Referencia","Notas"];
  const rows = PRODUCTOS.map(p => [
    p.nombre||"", p.categoria||"", p.sustancia||"", p.presentacion||"",
    p.para||"", p.codigo||"", p.pagina||"", p.notas||""
  ]);
  let csv = headers.join(",") + "\n";
  rows.forEach(r=>{
    csv += r.map(v => '"' + String(v).replace(/"/g,'""') + '"').join(",") + "\n";
  });
  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'Catalogo_Integral_ALPACEL.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}


let quizIndex = 0;

function openQuiz(){
  quizIndex = 0;
  document.getElementById('quizModal').style.display='block';
  nextQuiz();
}
function closeQuiz(){
  document.getElementById('quizModal').style.display='none';
}
function nextQuiz(){
  if(!Array.isArray(PRODUCTOS) || PRODUCTOS.length===0){
    document.getElementById('quizContent').innerHTML = "<div class='empty'>No hay productos cargados para preguntar üòÖ</div>";
    return;
  }
  const p = PRODUCTOS[Math.floor(Math.random()*PRODUCTOS.length)];
  const uso = p.para || "Seg√∫n ficha";
  const sust = p.sustancia || "Seg√∫n ficha";
  const cliente = p.categoria || "Seg√∫n categor√≠a";

  document.getElementById('quizContent').innerHTML = `
    <div class="pill" style="margin-bottom:10px;">Producto: <strong style="margin-left:6px;">${escapeHtml(p.nombre||"")}</strong></div>
    <ol style="margin:0; padding-left:18px;">
      <li><strong>¬øPara qu√© se recomienda?</strong></li>
      <li><strong>¬øQu√© contiene o cu√°l es su base?</strong></li>
      <li><strong>¬øA qu√© tipo de cliente lo sugerir√≠as?</strong></li>
    </ol>
    <details style="margin-top:12px;">
      <summary style="cursor:pointer;">Ver respuestas sugeridas</summary>
      <ul style="margin-top:10px;">
        <li><strong>Uso:</strong> ${escapeHtml(uso)}</li>
        <li><strong>Sustancia/base:</strong> ${escapeHtml(sust)}</li>
        <li><strong>Cliente ideal:</strong> ${escapeHtml(cliente)}</li>
      </ul>
    </details>
  `;
}

</script>
</body>
</html>
